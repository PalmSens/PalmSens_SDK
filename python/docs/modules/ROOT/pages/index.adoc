= PyPalmSens Documentation
:source-language: python

{empty} +
{empty}

image::banner.svg[PalmSens Python banner, width=80%]

{empty} +
{empty}

PyPalmSens is a Python library for automating electrochemistry experiments with your PalmSens instruments.
It provides an intuitive Python API, making it straightforward to integrate into your Python workflows.

With PyPalmSens, you can:

- Connect to one or more instruments/channels
- Automate electrochemistry measurements
- Access and process measured data
- Analyze and manipulate data
- Perform peak detection
- Do Equivalent Circuit Fitting on impedance data
- Take manual control of the cell
- Read and write method and data files

To install:

[,console]
----
pip install pypalmsens
----

PyPalmSens is built on top of the xref:start:ROOT:core.adoc[PalmSens .NET libraries],
and therefore requires the .NET runtime to be installed.
For specific installation instructions for your platform, see xref:installation.adoc[]

== Getting started

The following example shows how to set up and measure a simple chronoamperometry experiment:

----
>>> import pypalmsens as ps

>>> method = ps.ChronoAmperometry(
...     interval_time=0.01,
...     potential=1.0,
...     run_time=10.0,
... )

>>> ps.measure(method)  # <1>
Measurement(title=Chronoamperometry, timestamp=17-Nov-25 13:42:16, device=EmStat4HR)
----
<1> `measure` discovers any plugged-in device to start the measurement. An error is raised when more than 1 instruments are connected.

[TIP]
====
Shorten the imported name from `pypalmsens` to `ps`. This widely adopted convention helps with better readability of code.
====

The following example shows how to discover devices and manually read out the current.

----
>>> import pypalmsens as ps

>>> instruments = ps.discover()
>>> emstat4 = [inst for inst in instruments if inst.name.startswith('EmStat4')][0]

>>> with ps.connect(instrument=emstat4) as manager:  # <1>
...     manager.set_cell(True)
...     manager.set_potential(1)
...     manager.set_current_range(ps.settings.CURRENT_RANGE.cr_1_mA)
...
...     current = manager.read_current()
...     print(f'{current=} µA')
...
...     manager.set_cell(False)
current=92.8065 µA
----
<1> The context manager opens and closes the connection

Analyze a previous measurement with https://pandas.pydata.org/[pandas]:

----
>>> import pandas as pd
>>> import pypalmsens as ps

>>> measurements = ps.load_session_file('Demo CV DPV EIS IS-C electrode.pssession')

>>> frames = []
>>> frame_names = []

>>> for measurement in measurements:
...     frames.append(measurement.dataset.to_dataframe())  # <1>
...     frame_names.append(measurement.title)

>>> df = pd.concat(frames, keys=frame_names)
>>> print(df)
----
<1> Extract all arrays from the dataset into a https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html[pandas dataframe].

[#compatibility]
== Compatible devices and firmware

The table below lists the minimum supported firmwares versions and required drivers:

[cols=",,,",options="header",]
|===
| Instrument | Firmware version | Windows drivers | Linux/MacOS drivers

| Nexus
| 1.100
| palmsens_cdc.inf (optional) footnote:psdrivers[Drivers are installed with alongside the PSTrace desktop software or using https://github.com/PalmSens/PalmSens_SDK/releases/download/python-1.0.0/PalmSens.Drivers.exe[the driver installer].]
| n/a footnote:linuxserial[The SDK communicates directly via the serial port. No drivers are necessary.]

| Palmsens1
| 4.4
| PalmSens FTDI footnote:psdrivers[]
| Generic FTDI footnote:genericftdi[See xref:installation.adoc#req-linux[the installation instructions] for more info.]

| Palmsens2
| 4.4
| PalmSens FTDI footnote:psdrivers[]
| Generic FTDI footnote:genericftdi[]

| Palmsens3
| 2.8
| PalmSens FTDI footnote:psdrivers[]
| Generic FTDI footnote:genericftdi[]

| Palmsens4
| 1.7
| palmsens_cdc.inf (optional) footnote:psdrivers[]
| n/a footnote:linuxserial[]

| MultiPalmsens4
| 1.7
| Generic FTDI footnote:genericftdi[]
| Generic FTDI footnote:genericftdi[]

| EmStat1
| 3.7
| PalmSens FTDI footnote:psdrivers[]
| Generic FTDI footnote:genericftdi[]

| EmStat2
| 7.7
| PalmSens FTDI footnote:psdrivers[]
| Generic FTDI footnote:genericftdi[]

| EmStat3
| 7.7
| PalmSens FTDI footnote:psdrivers[]
| Generic FTDI footnote:genericftdi[]

| EmStat3+
| 7.7
| PalmSens FTDI footnote:psdrivers[]
| Generic FTDI footnote:genericftdi[]

| MultiEmStat3
| 7.7
| PalmSens FTDI footnote:psdrivers[]
| Generic FTDI footnote:genericftdi[]

| EmStat3 Blue
| 7.7
| PalmSens FTDI footnote:psdrivers[]
| Generic FTDI footnote:genericftdi[]

| EmStat3+ Blue
| 7.7
| PalmSens FTDI footnote:psdrivers[]
| Generic FTDI footnote:genericftdi[]

| EmStat3 Go
| 7.7
| PalmSens FTDI footnote:psdrivers[]
| Generic FTDI footnote:genericftdi[]

| EmStat3+ Go
| 7.7
| PalmSens FTDI footnote:psdrivers[]
| Generic FTDI footnote:genericftdi[]

| EmStat4S
| 1.307
| palmsens_cdc.inf (optional) footnote:psdrivers[]
| n/a footnote:linuxserial[]

| MultiEmStat4
| 1.307
| palmsens_cdc.inf (optional) footnote:psdrivers[]
| n/a footnote:linuxserial[]

| EmStat4X
| 1.307
| palmsens_winusb.inf (optional) footnote:psdrivers[]
| n/a footnote:linuxserial[]

| EmStat4R
| 1.307
| Generic FTDI footnote:genericftdi[]
| Generic FTDI footnote:genericftdi[]

| EmStat4M
| 1.307
| palmsens_cdc.inf (optional) footnote:psdrivers[]
| n/a footnote:linuxserial[]

| EmStat4T
| 1.406
| palmsens_cdc.inf (optional) footnote:psdrivers[]
| n/a footnote:linuxserial[]

| EmStat4 Go
| 1.307
| Generic FTDI footnote:genericftdi[]
| Generic FTDI footnote:genericftdi[]

| EmStat Pico DevBoard
| 1.601
| Generic FTDI (optional) footnote:genericftdi[]
| n/a footnote:linuxserial[]

| EmStat Pico Module
| 1.601
| Generic FTDI (optional) footnote:genericftdi[]
| n/a footnote:linuxserial[]

| EmStat Pico Go
| 1.601
| Generic FTDI (optional) footnote:genericftdi[]
| n/a footnote:linuxserial[]

| Sensit Smart
| 1.601
| Generic FTDI (optional) footnote:genericftdi[]
| n/a footnote:linuxserial[]

| Sensit BT
| 1.601
| Generic FTDI (optional) footnote:genericftdi[]
| n/a footnote:linuxserial[]

| Sensit Wearable
| 1.600
| Generic FTDI (optional) footnote:genericftdi[]
| n/a footnote:linuxserial[]
|===
